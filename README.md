# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Барышников Алексей`

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

---
### Активный master-сервер и пассивный репликационный slave-сервер  
  
Повышение отказоустойчивости. При падении основного master-сервера можно вручную (или с помощью скриптов) переключиться на slave-сервер, минимизировав время простоя.
Разгрузка основного сервера.  
Географическое распределение. Slave-сервер можно разместить в другом дата-центре для защиты от сбоев в основном месте размещения. 
Простота реализации и понимания. Концепция интуитивно понятна, а механизмы такой репликации хорошо отлажены в СУБД. 

### Master-сервер и несколько slave-серверов  
  
Это горизонтальное масштабирование предыдущей схемы.  
Преимущества:  
Масштабирование чтения. Это ключевое преимущество. Вся нагрузка по чтению данных распределяется между несколькими slave-серверами.  
Высокая доступность. Появляется несколько кандидатов на замену master-сервера в случае его сбоя, что повышает надежность системы.  
Специализация серверов. Разные slave-серверы можно заточить под разные задачи: один для отчетности, другой для кэширования, третий для резервных копий.  
Гео-распределение и локализация. Slave-серверы можно размещать в разных регионах, чтобы пользователи подключались к ближайшему серверу для чтения, уменьшая задержку.  

### Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)  
  
DRBD — это технология синхронной репликации данных на уровне блоков устройства.  
Преимущества:  
Синхронная репликация данных. Данные записываются на оба узла одновременно. Это гарантирует, что в случае падения активного сервера на резервном будет полная и актуальная копия данных.  
Прозрачность для приложений. Для работающего приложения DRBD выглядит как обычное блочное устройство (диск). Приложению не нужно знать о репликации, вся работа ведется на одном активном узле.  
Автоматический failover. В связке с кластерными менеджерами переключение при сбое происходит полностью автоматически, без вмешательства человека.  
Простота восстановления. После восстановления основного узла ресинхронизация происходит на уровне блоков, что часто эффективнее, чем логическая репликация в СУБД.  

### SAN-кластер  
  
SAN (Storage Area Network) — это выделенная сеть, объединяющая серверы и системы хранения данных. Кластер использует общее дисковое пространство в SAN.  
Преимущества:  
Разделяемое хранилище (Shared Storage). Все узлы кластера имеют доступ к одним и тем же дискам. Это устраняет необходимость в репликации данных между узлами, так как данные физически одни.  
Высокая скорость переключения (Fast Failover). Поскольку данные уже находятся на общем диске, резервному узлу не нужно копировать данные с активного. Он просто монтирует файловую систему и запускает службы, что происходит очень быстро.  
Централизованное управление хранилищем. Упрощается администрирование, резервное копирование и расширение дискового пространства, так как всё управляется централизованно на уровне SAN.  


---


### Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.*

---

### Блоксхема  
  

![Блоксхема](/img/1.jpg)  

### Архитектура системы:
  
**Веб-приложение** - обрабатывает все запросы и распределяет их по нужным шардам

**Шарды пользователей** - отдельные базы данных для разных групп пользователей (делим по ID)

**Шарды книг** - отдельные базы для книг разных магазинов (делим по ID магазина)

**Главная база магазинов** - одна общая база со списком всех магазинов

**Поисковая база** - отдельная система для быстрого поиска книг (используем Elasticsearch)  

### Режимы работы:  

**Шарды пользователей и книг** - работают как независимые Master-серверы

**Главная база магазинов** - Master, данные реплицируются на шарды книг

**Поисковая база** - копирует данные из всех шардов книг для быстрого поиска

### Преимущества:  

Быстрый доступ к книгам каждого магазина

Равномерное распределение пользователей

Эффективный поиск по книгам

Легко масштабировать при росте нагрузки
